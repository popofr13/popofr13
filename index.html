<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Title of the document</title>
</head>

<body>
Content of the document......
<script type="text/javascript">
    function askNotificationPermission() {
      console.log("[Index.html] Ask notification");

      console.debug(Notification);
        
      return new Promise(function(resolve, reject) {
        const permissionResult = Notification.requestPermission(function(result) {
          resolve(result);
        });
        if (permissionResult) {
          permissionResult.then(resolve, reject);
        }
      })
      .then(function(permissionResult) {
        if (permissionResult !== 'granted') {
          throw new Error('We weren\'t granted permission.');
        }
      });
    }
    
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/popofr13/service-worker.js').then(function(registration) {
                // Registration was successful
                console.log('[ServiceWorker registration successful with scope: ', registration.scope);
                
                askNotificationPermission();
            }, function(err) {
                // registration failed :(
                console.log('ServiceWorker registration failed: ', err);
            });
        });
    }
</script>  
</body>

</html>
